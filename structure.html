<!DOCTYPE html>
<html lang="en">
<head>

	<title>strucÂ·ture</title>

	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="A simple structural analysis tool, made by Tim Ngo.">

	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B" crossorigin="anonymous">
	<link rel="stylesheet" href="styles/structure.css">
	<link rel="stylesheet" href="styles/icons.css">

</head>
<body>

<div id="home">
	<a href="https://ngotm.github.io">ngotm.github.io</a>
</div>

<div id="app">

		<!-- Canvas -->
		<div id="canvas-container">

			<svg id="canvas" ref="canvas" 
					@mousedown.left.prevent="captureOn" 
					@mouseup.left="captureOff" 
					@mousemove="mo" 
					@wheel.prevent="zoomCanvas($event.deltaY)"
					draggable="false">
				<rect id="rect-canvas" width="100%" height="100%"></rect>
				<path v-show="viewSettings.axes" class="axis" :d="axisXDef"></path>
				<path v-show="viewSettings.axes" class="axis" :d="axisYDef"></path>
				<element-path
					v-for="(element, index) in elements"
					:key="element.id"
					:element="element"
					:element-force="elementForces[index]"
					:view="viewSettings"
				></element-path>
				<node-circle
					v-for="(node, index) in nodes"
					:key="node.id"
					:node="node"
					:reactions="nodeReactions[index]"
					:view="viewSettings"
				></node-circle>
				<text v-show="!isStable" :x="10" :y="20" fill="red">unstable</text>
			</svg>
			
			<!-- Display Settings -->
			<div id="canvas-settings-container">

					<transition name="slide-fade">
					<div id="canvas-settings" v-show="viewSettings.display">

						<div>Zoom (scroll canvas)</div>
						<div style="grid-column: span 2">
							<input type="range" class="form-control-range" 
									:max="viewSettings.scaleMax" step="any" v-model.number="viewSettings.scale">
						</div>

						<div>Origin offset (drag canvas)</div>
						<div>
							<input type="range" class="form-control-range" 
									min="0" :max="canvasW" v-model.number="viewSettings.x">
						</div>
						<div>
							<input type="range" class="form-control-range" 
								min="0" :max="canvasH" v-model.number="viewSettings.y"/>
						</div>
						
						<input-checkbox :object="viewSettings" :setting="'nodeLabels'" 
								:id="'checkbox-node-labels'" :label="'Node labels'"></input-checkbox>
						<input-checkbox :object="viewSettings" :setting="'appliedForces'" 
								:id="'checkbox-applied-forces'" :label="'Nodal loads'"></input-checkbox>
						<input-checkbox :object="viewSettings" :setting="'elementLoads'" 
								:id="'checkbox-element-loads'" :label="'Distributed loads'"></input-checkbox>
						<input-checkbox :object="viewSettings" :setting="'supports'" 
								:id="'checkbox-supports'" :label="'Supports'"></input-checkbox>
						<input-checkbox :object="viewSettings" :setting="'elementForces'" 
								:id="'checkbox-element-forces'" :label="'Axial forces'"></input-checkbox>
						<input-checkbox :object="viewSettings" :setting="'reactions'" 
								:id="'checkbox-reactions'" :label="'Reactions'"></input-checkbox>
						<input-checkbox :object="viewSettings" :setting="'reactions'" 
								:id="'checkbox-reactions'" :label="'Displacements'"></input-checkbox>
						<input-checkbox :object="viewSettings" :setting="'axes'" 
								:id="'checkbox-axes'" :label="'Axes'"></input-checkbox>

						<div style="grid-column: 1 / 2">Decimal places (0-9)</div>
						<div style="grid-column: span 1;">
							<input type="number" class="form-control form-control-sm" min="0" max="9" v-model.number="viewSettings.decimalPlaces">
						</div>
						
					</div>
				</transition>

					<div id="canvas-header">
						<div>Canvas</div>
						<button 
								class="btn btn-outline-dark" 
								@click="viewSettings.display=!viewSettings.display"
						>&#x2699;</button>
					</div>

			</div>
		</div>

		<!-- Node Table -->
		<table-array id="node-table" :heading="'Nodes'" :array="nodes" @expand="expandNodes" @collapse="collapseNodes">
			<template slot="header">
				<node-row-add
					:nodes="nodes"
					@submit="addNode"
				></node-row-add>
			</template>
			<template>
				<node-row
					v-for="(node, index) in nodes"
					ref="nodeRow"
					:key="node.id"
					:node="node"
					:nodes="nodes"
					@remove="removeNodeByIndex(nodes, elements, index)"
				></node-row>
			</template>
		</table-array>

		<!-- Element Table -->
		<table-array id="element-table" :heading="'Elements'" :array="elements" @expand="expandElems" @collapse="collapseElems">
				<template slot="header">
					<element-row-add
						:elements="elements"
						:nodes="nodes"
						@submit="addElement"
					></element-row-add>
				</template>
				<template>
					<element-row
						v-for="(element, index) in elements"
						ref="elemRow"
						:key="element.id"
						:element="element"
						:nodes="nodes"
						@remove="removeElementByIndex(elements, index)"
					></element-row>
				</template>
			</table-array>

</div>

<script src="https://cdn.jsdelivr.net/npm/lodash@4.17.10/lodash.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://unpkg.com/mathjs@5.0.4/dist/math.min.js"></script>
<script src="scripts/structure.js"></script>

</body>
</html>
